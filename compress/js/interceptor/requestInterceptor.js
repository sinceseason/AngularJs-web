define(function(){"use strict";return function(e){e.factory("RequestInterceptor",function(e,o,r,n){return{request:function(e){return r.spin("spinner"),e.headers=e.headers||{},sessionStorage.loginedUserId&&(e.headers.token=sessionStorage.loginedUserId),e},response:function(e){if(r.stop("spinner"),"POST"==e.config.method){var o=e.data;if("FAILED"==o.result&&1==o.errorCode)return getScope().rootDialogPage="./views/dialog/alarm/session_timeout.html",void n.showDialog("rootDialog")}return e},responseError:function(n){return r.stop("spinner"),"POST"==n.config.method&&-1==n.status&&"/login"!=o.path()&&(r.stop("spinner"),o.path("loginPage"),e.redirectToLoginPage()),n}}})}});